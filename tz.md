# Техническое задание на проект: RentAnalyzer

## 1. Цель проекта
Создание аналитического веб-сервиса для оценки рыночной стоимости аренды жилья. Сервис анализирует похожие предложения на рынке, учитывает район/местоположение и рассчитывает справедливую цену аренды на основе статистических данных.

## 2. Роли пользователей
- **Гость**: Просмотр главной страницы, информации о сервисе
- **Авторизованный пользователь**: Добавление своих квартир, запуск анализа, просмотр отчетов, сохранение истории анализов
- **Администратор**: Управление всеми данными через админ-панель

## 3. Модели данных
**Модель 1: City (Город)**
- Поля: name, slug, latitude, longitude, avg_price_per_sqm, population, description

**Модель 2: Apartment (Квартира пользователя)**
- Поля: user, city, address, area, rooms, floor, total_floors, has_balcony, repair_type, desired_price, latitude, longitude

**Модель 3: MarketOffer (Рыночное предложение)**
- Поля: city, source, address, area, rooms, price, floor, url, is_active, latitude, longitude

**Модель 4: AnalysisReport (Отчет анализа)**
- Поля: apartment, fair_price, price_difference, similar_offers_count, avg_price, median_price, min_price, max_price, avg_price_per_sqm, recommendation, chart_image_base64

## 4. Ключевой функционал
* Регистрация и авторизация пользователей
* Добавление квартиры с автоматическим геокодированием адреса через OpenStreetMap Nominatim API
* Поиск похожих рыночных предложений с учетом площади, цены, местоположения
* Статистический анализ рынка (средняя, медианная, минимальная, максимальная цены)
* Генерация рекомендаций по ценообразованию с визуализацией (графики Matplotlib)
* Сохранение истории анализов в личном кабинете

## 5. Внешние интеграции / Аналитика
**Интеграция с внешним API:**
- OpenStreetMap Nominatim API для геокодирования адресов

**Библиотеки для анализа данных:**
- Pandas для статистических расчетов
- Matplotlib для создания графиков визуализации
- NumPy для математических операций

## 6. Изменения в ходе реализации
- Добавлено поле `chart_image_base64` для хранения графиков в формате base64
- Реализована система кэширования геокодирования для уменьшения запросов к API
- Добавлена фильтрация по расстоянию при поиске похожих предложений