# Техническое задание: RentAnalyzer Pro

## 1. Цель проекта
Разработка веб-сервиса для анализа рынка аренды жилья, который помогает пользователям определить справедливую стоимость аренды их квартиры на основе статистического анализа рыночных данных. Система автоматически находит похожие предложения, проводит сравнительный анализ и выдает обоснованную оценку стоимости.

## 2. Роли пользователей
- **Гость**: Просмотр демо-анализа, общая статистика по городам, примеры расчетов
- **Зарегистрированный пользователь**: Полный доступ к функционалу, сохранение своих квартир, история анализов, личный кабинет
- **Администратор**: Управление контентом, модерация данных, настройки системы

## 3. Модели данных

### Модель 1: City (Город)
- `name` - Название города (CharField)
- `slug` - URL-идентификатор (SlugField)
- `avg_price_per_sqm` - Средняя цена за м² (DecimalField)
- `population` - Население (IntegerField, опционально)
- `description` - Описание города (TextField)

### Модель 2: Apartment (Квартира пользователя)
- `user` - Связь с пользователем (ForeignKey to User)
- `city` - Связь с городом (ForeignKey to City)
- `address` - Адрес (CharField)
- `area` - Площадь (м²) (DecimalField)
- `rooms` - Количество комнат (IntegerField)
- `floor` - Этаж (IntegerField)
- `total_floors` - Всего этажей в доме (IntegerField)
- `has_balcony` - Наличие балкона/лоджии (BooleanField)
- `repair_type` - Тип ремонта (CharField с choices)
- `description` - Дополнительное описание (TextField)
- `desired_price` - Желаемая цена аренды (DecimalField)
- `created_at` - Дата добавления (DateTimeField, auto_now_add)

### Модель 3: MarketOffer (Рыночное предложение)
- `city` - Связь с городом (ForeignKey to City)
- `source` - Источник данных (CharField: 'avito', 'cian', 'mock')
- `external_id` - ID во внешней системе (CharField)
- `address` - Адрес предложения (CharField)
- `area` - Площадь (DecimalField)
- `rooms` - Количество комнат (IntegerField)
- `price` - Цена аренды (DecimalField)
- `url` - Ссылка на оригинальное объявление (URLField)
- `is_active` - Активно ли предложение (BooleanField)
- `parsed_date` - Дата получения данных (DateTimeField)

### Модель 4: AnalysisReport (Отчет анализа)
- `apartment` - Связь с квартирой (OneToOneField to Apartment)
- `fair_price` - Расчетная справедливая цена (DecimalField)
- `price_difference` - Разница с желаемой ценой пользователя (DecimalField)
- `similar_offers_count` - Количество найденных похожих предложений (IntegerField)
- `avg_price_per_sqm` - Средняя цена за м² по выборке (DecimalField)
- `median_price` - Медианная цена (DecimalField)
- `price_range` - Диапазон цен (CharField, формат "мин-макс")
- `chart_image` - График распределения цен (ImageField)
- `recommendation` - Текстовая рекомендация (TextField)
- `created_at` - Дата создания отчета (DateTimeField, auto_now_add)

## 4. Ключевой функционал (User Stories)

1. **Регистрация и аутентификация**
   - Пользователь регистрируется в системе, подтверждает email
   - Получает доступ к личному кабинету

2. **Добавление квартиры для анализа**
   - Пользователь заполняет форму с параметрами квартиры (город, площадь, комнаты, этаж и т.д.)
   - Система валидирует данные и сохраняет объект

3. **Запуск анализа**
   - Пользователь нажимает "Проанализировать" для своей квартиры
   - Система находит похожие предложения на рынке
   - Проводит статистический анализ и рассчитывает справедливую цену

4. **Просмотр отчета**
   - Пользователь видит детальный отчет с графиком распределения цен
   - Получает рекомендации (завышена/занижена цена, оптимальный диапазон)
   - Может сохранить отчет в PDF

5. **Мониторинг рынка**
   - Пользователь получает уведомления при появлении новых выгодных предложений
   - Может отслеживать динамику цен в выбранных районах

## 5. Внешние интеграции / Аналитика

### Внешние API:
- **OpenStreetMap/Nominatim API** - для геокодирования адресов
- **Telegram Bot API** (опционально) - для отправки уведомлений

### Библиотеки для анализа данных:
- **Pandas** - для агрегации и анализа данных
- **NumPy** - для статистических расчетов
- **Matplotlib/Plotly** - для построения графиков и визуализации

### Аналитические модули:
1. Статистический анализ выборки (среднее, медиана, квартили)
2. Расчет корреляций между параметрами
3. Определение аномалий цен (выбросов)
4. Сравнение с историческими данными

---

## Изменения в ходе реализации
*24.12.2025* - Создана базовая структура проекта Django. Определены 4 основные модели данных. Временно отложена установка библиотек для анализа данных (matplotlib, pandas, numpy) из-за проблем с компиляцией на Windows. Будет решено позже через установку предварительно собранных пакетов.